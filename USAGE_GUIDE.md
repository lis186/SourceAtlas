# SourceAtlas - 使用指南

**版本**: v1.0 完成，v2.5 開發中
**更新時間**: 2025-11-22

---

## 📖 快速開始

### 5 分鐘入門

**步驟 1: 選擇要分析的專案**
```bash
cd /path/to/target/project
```

**步驟 2: 執行 Stage 0 分析**

將 `PROMPTS.md` 中的 "Stage 0: Project Fingerprint" prompt 複製到 Claude，替換 `[PROJECT_PATH]` 為實際路徑。

**步驟 3: 查看結果**

你會得到一個 `.yaml` 格式的報告，包含：
- 技術棧識別
- 架構模式推論
- 10-15 個假設（供 Stage 1 驗證）
- 開發者能力初步評估

**步驟 4: （可選）執行 Stage 1-2**

如果需要更深入的理解，繼續執行 Stage 1 和 Stage 2。

---

## 🎯 何時使用 SourceAtlas？

### ✅ 適合的場景

1. **接手新專案**
   - 快速理解專案架構
   - 識別技術債務
   - 評估代碼品質

2. **Code Review**
   - 了解開發者能力
   - 識別潛在問題
   - 驗證架構設計

3. **技術盡職調查**
   - 評估收購目標的代碼品質
   - 估算維護成本
   - 識別風險

4. **學習優秀專案**
   - 理解專案結構
   - 學習架構模式
   - 研究開發流程

5. **招聘評估**
   - 評估候選人的 GitHub 專案
   - 驗證能力聲明
   - 了解開發習慣

### ❌ 不適合的場景

1. **極小專案** (<500 行)
   - 直接讀完整專案更快

2. **需要深度理解業務邏輯**
   - SourceAtlas 專注於架構和模式
   - 不深入具體業務細節

3. **需要找特定 Bug**
   - 用傳統 debug 工具更合適

---

## 📊 Stage 選擇指南

### 決策樹

```
專案代碼量？
├─ <500 行
│  └─ 不需要 SourceAtlas，直接讀完整專案
│
├─ 500-2000 行
│  └─ 使用 Stage 0-1
│     ├─ Stage 0: 建立輪廓
│     └─ Stage 1: 驗證假設
│
└─ >2000 行
   └─ 使用 Stage 0-2 (完整流程)
      ├─ Stage 0: 建立輪廓
      ├─ Stage 1: 驗證假設
      └─ Stage 2: Git 分析
```

### Stage 對比

| 需求 | Stage 0 | Stage 1 | Stage 2 |
|------|---------|---------|---------|
| 快速了解技術棧 | ✅ | - | - |
| 驗證架構假設 | - | ✅ | - |
| 了解開發模式 | - | - | ✅ |
| 評估開發者能力 | ⭐ | ⭐⭐ | ⭐⭐⭐ |
| 識別 AI 協作 | ⭐ | ⭐⭐ | ⭐⭐⭐ |
| 時間投入 | 10-15 分鐘 | 20-30 分鐘 | 15-20 分鐘 |
| Token 使用 | ~20k | ~30k | ~20k |

---

## 🔍 詳細使用流程

### Stage 0: Project Fingerprint

**目標**: 掃描 <5% 檔案達到 70-80% 理解

**準備工作**:
1. 確保專案目錄可訪問
2. 確認有 Git 歷史（optional，但有助於分析）
3. 準備好執行 shell 命令的權限

**執行步驟**:

1. **使用 Prompt**
   ```
   複製 PROMPTS.md 中的 "Stage 0: Project Fingerprint" prompt
   替換 [PROJECT_PATH] 為實際路徑
   提交給 Claude
   ```

2. **Claude 會自動**:
   - 掃描配置檔案 (package.json, composer.json)
   - 讀取 README.md
   - 掃描專案結構
   - 讀取 3-5 個核心 Model 檔案
   - 生成假設

3. **你會得到**:
   - 一個 `.yaml` 格式的報告
   - 10-15 個待驗證的假設（規模感知調整）
   - 技術棧和架構的推論
   - 開發者能力初步評估

**檢查清單**:
- [ ] 技術棧識別正確？
- [ ] 有明確的假設清單？
- [ ] 開發者能力評估合理？
- [ ] 掃描檔案數 <5%？

**常見問題**:

Q: Stage 0 輸出太長怎麼辦？
A: 這是正常的，YAML 格式設計為完整記錄。可以重點看 `project_fingerprint` 和 `hypotheses` 部分。

Q: 假設太多/太少？
A: 理想是 10-15 個。太多說明不夠聚焦，太少可能遺漏重點。

Q: 信心等級如何解讀？
A: 0.0-0.5 (低), 0.5-0.7 (中), 0.7-0.85 (高), 0.85-1.0 (極高)

---

### Stage 1: Hypothesis Validation

**目標**: 驗證 Stage 0 的假設，達到 85-95% 理解

**準備工作**:
1. 完成 Stage 0 分析
2. 閱讀 Stage 0 報告，理解假設清單
3. 準備好執行驗證命令

**執行步驟**:

1. **提供 Stage 0 報告**
   ```
   先讓 Claude 讀取 Stage 0 報告
   然後使用 Stage 1 prompt
   ```

2. **Claude 會自動**:
   - 提取所有假設
   - 為每個假設設計驗證方法
   - 執行驗證（grep, ls, find 等）
   - 記錄證據
   - 更新信心等級

3. **你會得到**:
   - 驗證報告 (.md 格式)
   - 每個假設的確認/推翻結果
   - 驗證準確率統計
   - 更新後的專案理解

**檢查清單**:
- [ ] 所有假設都被驗證？
- [ ] 每個結論有明確證據？
- [ ] 準確率 >80%？
- [ ] 識別出 Stage 0 的錯誤？

**常見問題**:

Q: 準確率低於 80% 怎麼辦？
A: 這是正常的！Stage 0 是推論，有些推論會被推翻。重要的是學習為什麼推翻。

Q: 如何改進 Stage 0？
A: Stage 1 報告會提供改進建議。基於這些建議優化 Stage 0 prompt。

Q: 無法驗證某些假設？
A: 標記為"需要更多資訊"，說明為什麼無法驗證。

---

### Stage 2: Git Hotspots Analysis

**目標**: 識別開發模式和演進，理解深度達到 95%+

**準備工作**:
1. 確認專案有 Git 歷史
2. 完成 Stage 0-1 (optional，但有助於理解)
3. 確保可以執行 Git 命令

**執行步驟**:

1. **使用 Prompt**
   ```
   複製 Stage 2 prompt
   替換 [PROJECT_PATH]
   提交給 Claude
   ```

2. **Claude 會自動**:
   - 分析 commit 歷史
   - 識別檔案熱點
   - 重建時間線
   - 分析開發模式
   - 評估 AI 協作證據

3. **你會得到**:
   - Git 熱點報告 (.md 格式)
   - 完整的時間線重建
   - 開發模式分析
   - 開發者能力評估

**檢查清單**:
- [ ] 時間線完整？
- [ ] 識別所有關鍵階段？
- [ [ 找出檔案熱點？
- [ ] AI 協作證據充分？

**常見問題**:

Q: 專案沒有 Git 歷史怎麼辦？
A: 跳過 Stage 2，或者只做部分分析（如果有部分歷史）。

Q: Git 歷史太長（1000+ commits）？
A: Stage 2 仍然有效。Git 命令會自動聚合和統計。

Q: 如何識別 AI 協作？
A: 看 commit message 一致性、註解密度、CLAUDE.md 等檔案。

---

## 📋 輸出格式說明

### YAML 格式 (.yaml)

**用於**: Stage 0 報告

**特點**:
- 標準格式，廣泛生態系統支援
- 極佳的人類可讀性
- 完整的 IDE 和工具支援
- 包含完整的 metadata

**v1.0 決策**: 選擇 YAML 而非自訂 TOON 格式（詳見 `.dev-notes/toon-vs-yaml-analysis.md`）

**範例**:
```yaml
metadata:
  project_name: example
  developer: john_doe
  scan_time: "2025-11-22T10:00:00Z"

project_fingerprint:
  project_type: WEB_APP
  architecture: MVC
  scale: MEDIUM
```

### Markdown 格式 (.md)

**用於**: Stage 1-2 報告

**特點**:
- 易讀
- 支援表格、列表
- 可以直接在 GitHub 上查看

---

## 🎯 進階技巧

### 技巧 1: 並行分析多專案

```bash
# 創建批次分析腳本
for project in project1 project2 project3; do
  echo "Analyzing $project..."
  # 對每個專案執行 Stage 0-2
done
```

### 技巧 2: 自定義假設

在 Stage 0 後，你可以手動添加假設到清單中，然後在 Stage 1 驗證。

### 技巧 3: 聚焦特定領域

修改 Prompt，聚焦於特定領域：
- 只分析測試相關
- 只分析安全性
- 只分析性能

### 技巧 4: 對比分析

使用三方對比報告模板，對比多個專案或開發者。

### 技巧 5: 持續追蹤

定期（如每月）執行分析，追蹤專案演進和開發者成長。

---

## ⚠️ 常見陷阱

### 陷阱 1: 過度依賴 Stage 0

**問題**: Stage 0 是推論，不是事實。

**解決**:
- 總是執行 Stage 1 驗證關鍵假設
- 對低信心的推論保持懷疑

### 陷阱 2: 忽略上下文

**問題**: 代碼品質評估需要考慮專案類型。

**解決**:
- 學習專案 vs 生產專案有不同標準
- 個人專案 vs 團隊專案有不同標準

### 陷阱 3: 只看數字

**問題**: 測試覆蓋率 90% 不代表高品質。

**解決**:
- 結合多個維度評估
- 看質量，不只是數量

### 陷阱 4: 忘記更新理解

**問題**: Stage 1 推翻了假設，但沒更新理解。

**解決**:
- 基於驗證結果更新專案理解
- 記錄為什麼某些假設被推翻

---

## 📊 結果解讀指南

### 開發者能力評估

**評分標準**:

| 等級 | 總分 | 特徵 | 代表 |
|------|------|------|------|
| **初學者** | 0-3 | 缺乏基礎知識，代碼混亂 | chiahsing1115 |
| **中級** | 4-6 | 掌握基礎，有架構意識 | - |
| **高級** | 7-8 | 專業品質，高測試覆蓋率 | taiwan-calendar |
| **專家/AI** | 9-10 | 極高產能或 AI 協作 | Mir01 |

**關鍵指標**:
- 代碼規模（lines of code）
- 測試覆蓋率（test coverage）
- Git 習慣（commit quality）
- 架構清晰度（architecture clarity）
- 文檔完整度（documentation）

### AI 協作識別

**Level 0: 無 AI**
- 無 AI 配置檔案
- 註解密度 <5%
- Commit message 不規範

**Level 1-2: 基礎使用**
- 偶爾使用 AI 工具
- 無系統化流程

**Level 3: 系統化 ⭐**
- 有 CLAUDE.md 或類似規範
- 註解密度 15-20%
- 100% Conventional Commits
- 代碼一致性 98%+

**Level 4: 生態化**
- 團隊級別 AI 協作
- 跨專案知識沉澱
- （尚未見到實例）

### 技術債務評估

**極低**: 有系統化追蹤，及時修復
- 例: taiwan-calendar

**低**: 有識別，計劃修復
- 例: Mir01

**中**: 有識別，未計劃
- 大多數專案

**高**: 沒有識別，累積嚴重
- 例: chiahsing1115

---

## 🎓 學習案例

### 案例 1: 評估初學者專案

**背景**: chiahsing1115 的 5 個專案

**分析結果**:
- Stage 0: 快速識別缺乏數據持久化
- Stage 1: 驗證所有 5 個專案都無持久化
- Stage 2: Git 習慣極差（1-2 commits）

**洞察**:
- 正在學習基礎
- 需要導師指導
- 建議優先學習數據持久化

### 案例 2: 評估專業專案

**背景**: taiwan-calendar-mcp-server (15k 行)

**分析結果**:
- Stage 0: 識別出專業級架構
- Stage 1: 100% 假設驗證成功
- Stage 2: 發現 92.27% 測試覆蓋率

**洞察**:
- 專業工程師水準
- TDD 開發模式
- 代碼品質極高

### 案例 3: 識別 AI 協作

**背景**: Mir01 (156k 行，2 個月開發)

**分析結果**:
- Stage 0: 發現 CLAUDE.md 配置
- Stage 1: 驗證出規範與實際差異
- Stage 2: 識別 Level 3 系統化 AI 協作

**洞察**:
- AI 輔助開發的成熟案例
- 規範是"理想"而非"現狀"
- 文檔/代碼比 3:1

---

## 🔧 troubleshooting

### 問題 1: Claude 超過 Token 限制

**症狀**: Claude 回應被截斷

**解決**:
1. 減少掃描檔案數量
2. 分階段執行（先 Stage 0，再 Stage 1）
3. 聚焦特定領域

### 問題 2: Git 命令失敗

**症狀**: `fatal: not a git repository`

**解決**:
1. 確認在正確目錄
2. 檢查是否有 .git 目錄
3. 如果沒有 Git 歷史，跳過 Stage 2

### 問題 3: 無法讀取某些檔案

**症狀**: Permission denied

**解決**:
1. 檢查檔案權限
2. 使用 sudo（如果適當）
3. 跳過受保護的檔案

### 問題 4: Stage 0 推論不準確

**症狀**: Stage 1 驗證率 <60%

**解決**:
1. 檢查是否掃描了正確的檔案
2. 是否遺漏了關鍵配置檔案
3. 調整 Stage 0 prompt，增加特定領域檢查

---

## 📚 延伸閱讀

- `PROMPTS.md` - 完整 Prompt 模板
- `EVALUATION_STANDARDS.md` - 評估標準體系
- `THREE-WAY-DEVELOPER-COMPARISON.md` - 對比案例研究
- `test_results/` - 實際分析案例

---

## 💬 獲得幫助

**常見問題**: 查看本文檔的 troubleshooting 部分

**GitHub Issues**: [報告問題或建議](https://github.com/your-repo/issues)

**社群討論**: [加入討論](https://github.com/your-repo/discussions)

---

**文檔版本**: v1.0 完成，v2.5 開發中
**最後更新**: 2025-11-22
**維護者**: SourceAtlas Team
